{"version":3,"file":"service.js","names":["_SdkConfig","_interopRequireDefault","require","_UserIdentifier","_MatrixClientPeg","_axios","getAllEnabledNfts","details","UserIdentifierCustomisations","getDisplayUserIdentifier","MatrixClientPeg","get","getSafeUserId","withDisplayName","data","userData","axios","post","SdkConfig","address","enableFeatures","e","console","error","getAllFeatures","features","exports","isComponentEnabled","title","userNfts","userHaveNft","adminEnable","forEach","nft","feature","includes","length","_default","default"],"sources":["../src/service.ts"],"sourcesContent":["import SdkConfig from \"./SdkConfig\";\r\nimport UserIdentifierCustomisations from \"./customisations/UserIdentifier\";\r\nimport { MatrixClientPeg } from \"./MatrixClientPeg\";\r\nimport axios from \"axios\";\r\nconst getAllEnabledNfts = async () => {\r\n    try {\r\n        const details = UserIdentifierCustomisations.getDisplayUserIdentifier(\r\n            MatrixClientPeg.get().getSafeUserId(),\r\n            {\r\n                withDisplayName: true,\r\n            },\r\n        );\r\n        const { data: userData } = await axios.post(`${SdkConfig.get(\"backend_url\")}/my-address`, {\r\n            address: details,\r\n        });\r\n        const { data: enableFeatures } = await axios.get(\r\n            `${SdkConfig.get(\"backend_url\")}/my-features/${userData.address}/main/enabled`,\r\n        );\r\n        return enableFeatures;\r\n    } catch (e) {\r\n        console.error(e);\r\n    }\r\n    return {};\r\n}\r\nexport const getAllFeatures = async ():Promise<any> =>{\r\n   try{\r\n    const features = await axios.get(`${SdkConfig.get('backend_url')}/always-enabled-feature`);\r\n    return features;\r\n   }  catch (e) {\r\n    console.error(e);\r\n   }\r\n   return {};\r\n}\r\nexport const isComponentEnabled = async(title:string)=>{\r\n    try{\r\n        const userNfts = await getAllEnabledNfts();\r\n        const { data } = await getAllFeatures();        \r\n        let userHaveNft = false;\r\n        let adminEnable = false;\r\n        if (userNfts[\"nfts\"]) {\r\n            userNfts[\"nfts\"].forEach((nft)=>{\r\n                if(nft.feature.includes(title)){\r\n                    userHaveNft = true;\r\n                }\r\n            })\r\n        }\r\n        if (data.length > 0) {\r\n            data.forEach((feature)=>{\r\n                if(feature.feature ===title){\r\n                    adminEnable = true;\r\n                }\r\n            })\r\n        }        \r\n        return userHaveNft || adminEnable;\r\n    }catch(e){\r\n        console.error(e);\r\n    }\r\n    return false;\r\n}\r\nexport default getAllEnabledNfts;\r\n"],"mappings":";;;;;;;AAAA,IAAAA,UAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,eAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,gBAAA,GAAAF,OAAA;AACA,IAAAG,MAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,MAAMI,iBAAiB,GAAG,MAAAA,CAAA,KAAY;EAClC,IAAI;IACA,MAAMC,OAAO,GAAGC,uBAA4B,CAACC,wBAAwB,CACjEC,gCAAe,CAACC,GAAG,CAAC,CAAC,CAACC,aAAa,CAAC,CAAC,EACrC;MACIC,eAAe,EAAE;IACrB,CACJ,CAAC;IACD,MAAM;MAAEC,IAAI,EAAEC;IAAS,CAAC,GAAG,MAAMC,cAAK,CAACC,IAAI,CAAE,GAAEC,kBAAS,CAACP,GAAG,CAAC,aAAa,CAAE,aAAY,EAAE;MACtFQ,OAAO,EAAEZ;IACb,CAAC,CAAC;IACF,MAAM;MAAEO,IAAI,EAAEM;IAAe,CAAC,GAAG,MAAMJ,cAAK,CAACL,GAAG,CAC3C,GAAEO,kBAAS,CAACP,GAAG,CAAC,aAAa,CAAE,gBAAeI,QAAQ,CAACI,OAAQ,eACpE,CAAC;IACD,OAAOC,cAAc;EACzB,CAAC,CAAC,OAAOC,CAAC,EAAE;IACRC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;EACpB;EACA,OAAO,CAAC,CAAC;AACb,CAAC;AACM,MAAMG,cAAc,GAAG,MAAAA,CAAA,KAAwB;EACnD,IAAG;IACF,MAAMC,QAAQ,GAAG,MAAMT,cAAK,CAACL,GAAG,CAAE,GAAEO,kBAAS,CAACP,GAAG,CAAC,aAAa,CAAE,yBAAwB,CAAC;IAC1F,OAAOc,QAAQ;EAChB,CAAC,CAAE,OAAOJ,CAAC,EAAE;IACZC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;EACjB;EACA,OAAO,CAAC,CAAC;AACZ,CAAC;AAAAK,OAAA,CAAAF,cAAA,GAAAA,cAAA;AACM,MAAMG,kBAAkB,GAAG,MAAMC,KAAY,IAAG;EACnD,IAAG;IACC,MAAMC,QAAQ,GAAG,MAAMvB,iBAAiB,CAAC,CAAC;IAC1C,MAAM;MAAEQ;IAAK,CAAC,GAAG,MAAMU,cAAc,CAAC,CAAC;IACvC,IAAIM,WAAW,GAAG,KAAK;IACvB,IAAIC,WAAW,GAAG,KAAK;IACvB,IAAIF,QAAQ,CAAC,MAAM,CAAC,EAAE;MAClBA,QAAQ,CAAC,MAAM,CAAC,CAACG,OAAO,CAAEC,GAAG,IAAG;QAC5B,IAAGA,GAAG,CAACC,OAAO,CAACC,QAAQ,CAACP,KAAK,CAAC,EAAC;UAC3BE,WAAW,GAAG,IAAI;QACtB;MACJ,CAAC,CAAC;IACN;IACA,IAAIhB,IAAI,CAACsB,MAAM,GAAG,CAAC,EAAE;MACjBtB,IAAI,CAACkB,OAAO,CAAEE,OAAO,IAAG;QACpB,IAAGA,OAAO,CAACA,OAAO,KAAIN,KAAK,EAAC;UACxBG,WAAW,GAAG,IAAI;QACtB;MACJ,CAAC,CAAC;IACN;IACA,OAAOD,WAAW,IAAIC,WAAW;EACrC,CAAC,QAAMV,CAAC,EAAC;IACLC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;EACpB;EACA,OAAO,KAAK;AAChB,CAAC;AAAAK,OAAA,CAAAC,kBAAA,GAAAA,kBAAA;AAAA,IAAAU,QAAA,GACc/B,iBAAiB;AAAAoB,OAAA,CAAAY,OAAA,GAAAD,QAAA"}