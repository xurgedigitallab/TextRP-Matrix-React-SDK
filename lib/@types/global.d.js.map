{"version":3,"file":"global.d.js","names":["require"],"sources":["../../src/@types/global.d.ts"],"sourcesContent":["/*\r\nCopyright 2020-2021 The Matrix.org Foundation C.I.C.\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n*/\r\n\r\nimport \"matrix-js-sdk/src/@types/global\"; // load matrix-js-sdk's type extensions first\r\nimport \"@types/modernizr\";\r\n\r\nimport ContentMessages from \"../ContentMessages\";\r\nimport { IMatrixClientPeg } from \"../MatrixClientPeg\";\r\nimport ToastStore from \"../stores/ToastStore\";\r\nimport DeviceListener from \"../DeviceListener\";\r\nimport { RoomListStore } from \"../stores/room-list/Interface\";\r\nimport { PlatformPeg } from \"../PlatformPeg\";\r\nimport RoomListLayoutStore from \"../stores/room-list/RoomListLayoutStore\";\r\nimport { IntegrationManagers } from \"../integrations/IntegrationManagers\";\r\nimport { ModalManager } from \"../Modal\";\r\nimport SettingsStore from \"../settings/SettingsStore\";\r\nimport { Notifier } from \"../Notifier\";\r\nimport type { Renderer } from \"react-dom\";\r\nimport RightPanelStore from \"../stores/right-panel/RightPanelStore\";\r\nimport WidgetStore from \"../stores/WidgetStore\";\r\nimport LegacyCallHandler from \"../LegacyCallHandler\";\r\nimport UserActivity from \"../UserActivity\";\r\nimport { ModalWidgetStore } from \"../stores/ModalWidgetStore\";\r\nimport { WidgetLayoutStore } from \"../stores/widgets/WidgetLayoutStore\";\r\nimport VoipUserMapper from \"../VoipUserMapper\";\r\nimport { SpaceStoreClass } from \"../stores/spaces/SpaceStore\";\r\nimport TypingStore from \"../stores/TypingStore\";\r\nimport { EventIndexPeg } from \"../indexing/EventIndexPeg\";\r\nimport { VoiceRecordingStore } from \"../stores/VoiceRecordingStore\";\r\nimport PerformanceMonitor from \"../performance\";\r\nimport UIStore from \"../stores/UIStore\";\r\nimport { SetupEncryptionStore } from \"../stores/SetupEncryptionStore\";\r\nimport { RoomScrollStateStore } from \"../stores/RoomScrollStateStore\";\r\nimport { ConsoleLogger, IndexedDBLogStore } from \"../rageshake/rageshake\";\r\nimport ActiveWidgetStore from \"../stores/ActiveWidgetStore\";\r\nimport AutoRageshakeStore from \"../stores/AutoRageshakeStore\";\r\nimport { IConfigOptions } from \"../IConfigOptions\";\r\nimport { MatrixDispatcher } from \"../dispatcher/dispatcher\";\r\nimport { DeepReadonly } from \"./common\";\r\n\r\n/* eslint-disable @typescript-eslint/naming-convention */\r\n\r\ndeclare global {\r\n    interface Window {\r\n        matrixChat: ReturnType<Renderer>;\r\n        mxMatrixClientPeg: IMatrixClientPeg;\r\n        Olm: {\r\n            init: () => Promise<void>;\r\n        };\r\n        mxReactSdkConfig: DeepReadonly<IConfigOptions>;\r\n\r\n        // Needed for Safari, unknown to TypeScript\r\n        webkitAudioContext: typeof AudioContext;\r\n\r\n        // https://docs.microsoft.com/en-us/previous-versions/hh772328(v=vs.85)\r\n        // we only ever check for its existence, so we can ignore its actual type\r\n        MSStream?: unknown;\r\n\r\n        // https://github.com/microsoft/TypeScript-DOM-lib-generator/issues/1029#issuecomment-869224737\r\n        // https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas\r\n        OffscreenCanvas?: {\r\n            new (width: number, height: number): OffscreenCanvas;\r\n        };\r\n\r\n        mxContentMessages: ContentMessages;\r\n        mxToastStore: ToastStore;\r\n        mxDeviceListener: DeviceListener;\r\n        mxRoomListStore: RoomListStore;\r\n        mxRoomListLayoutStore: RoomListLayoutStore;\r\n        mxPlatformPeg: PlatformPeg;\r\n        mxIntegrationManagers: typeof IntegrationManagers;\r\n        singletonModalManager: ModalManager;\r\n        mxSettingsStore: SettingsStore;\r\n        mxNotifier: typeof Notifier;\r\n        mxRightPanelStore: RightPanelStore;\r\n        mxWidgetStore: WidgetStore;\r\n        mxWidgetLayoutStore: WidgetLayoutStore;\r\n        mxLegacyCallHandler: LegacyCallHandler;\r\n        mxUserActivity: UserActivity;\r\n        mxModalWidgetStore: ModalWidgetStore;\r\n        mxVoipUserMapper: VoipUserMapper;\r\n        mxSpaceStore: SpaceStoreClass;\r\n        mxVoiceRecordingStore: VoiceRecordingStore;\r\n        mxTypingStore: TypingStore;\r\n        mxEventIndexPeg: EventIndexPeg;\r\n        mxPerformanceMonitor: PerformanceMonitor;\r\n        mxPerformanceEntryNames: any;\r\n        mxUIStore: UIStore;\r\n        mxSetupEncryptionStore?: SetupEncryptionStore;\r\n        mxRoomScrollStateStore?: RoomScrollStateStore;\r\n        mxActiveWidgetStore?: ActiveWidgetStore;\r\n        mxOnRecaptchaLoaded?: () => void;\r\n        electron?: Electron;\r\n        mxSendSentryReport: (userText: string, issueUrl: string, error: Error) => Promise<void>;\r\n        mxLoginWithAccessToken: (hsUrl: string, accessToken: string) => Promise<void>;\r\n        mxAutoRageshakeStore?: AutoRageshakeStore;\r\n        mxDispatcher: MatrixDispatcher;\r\n    }\r\n\r\n    interface Electron {\r\n        // will be extended by element-web downstream\r\n    }\r\n\r\n    interface DesktopCapturerSource {\r\n        id: string;\r\n        name: string;\r\n        thumbnailURL: string;\r\n    }\r\n\r\n    interface GetSourcesOptions {\r\n        types: Array<string>;\r\n        thumbnailSize?: {\r\n            height: number;\r\n            width: number;\r\n        };\r\n        fetchWindowIcons?: boolean;\r\n    }\r\n\r\n    interface Document {\r\n        // Safari & IE11 only have this prefixed: we used prefixed versions\r\n        // previously so let's continue to support them for now\r\n        webkitExitFullscreen(): Promise<void>;\r\n        msExitFullscreen(): Promise<void>;\r\n        readonly webkitFullscreenElement: Element | null;\r\n        readonly msFullscreenElement: Element | null;\r\n    }\r\n\r\n    interface Navigator {\r\n        userLanguage?: string;\r\n    }\r\n\r\n    interface StorageEstimate {\r\n        usageDetails?: { [key: string]: number };\r\n    }\r\n\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas\r\n    interface OffscreenCanvas {\r\n        convertToBlob(opts?: { type?: string; quality?: number }): Promise<Blob>;\r\n    }\r\n\r\n    interface HTMLAudioElement {\r\n        type?: string;\r\n        // sinkId & setSinkId are experimental and typescript doesn't know about them\r\n        sinkId: string;\r\n        setSinkId(outputId: string): void;\r\n    }\r\n\r\n    interface HTMLVideoElement {\r\n        type?: string;\r\n        // sinkId & setSinkId are experimental and typescript doesn't know about them\r\n        sinkId: string;\r\n        setSinkId(outputId: string): void;\r\n    }\r\n\r\n    // Add Chrome-specific `instant` ScrollBehaviour\r\n    type _ScrollBehavior = ScrollBehavior | \"instant\";\r\n\r\n    interface _ScrollOptions {\r\n        behavior?: _ScrollBehavior;\r\n    }\r\n\r\n    interface _ScrollIntoViewOptions extends _ScrollOptions {\r\n        block?: ScrollLogicalPosition;\r\n        inline?: ScrollLogicalPosition;\r\n    }\r\n\r\n    interface Element {\r\n        // Safari & IE11 only have this prefixed: we used prefixed versions\r\n        // previously so let's continue to support them for now\r\n        webkitRequestFullScreen(options?: FullscreenOptions): Promise<void>;\r\n        msRequestFullscreen(options?: FullscreenOptions): Promise<void>;\r\n        scrollIntoView(arg?: boolean | _ScrollIntoViewOptions): void;\r\n    }\r\n\r\n    interface Error {\r\n        // Standard\r\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/cause\r\n        cause?: unknown;\r\n\r\n        // Non-standard\r\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/fileName\r\n        fileName?: string;\r\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/lineNumber\r\n        lineNumber?: number;\r\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/columnNumber\r\n        columnNumber?: number;\r\n    }\r\n\r\n    // We can remove these pieces if we ever update to `target: \"es2022\"` in our\r\n    // TypeScript config which supports the new `cause` property, see\r\n    // https://github.com/vector-im/element-web/issues/24913\r\n    interface ErrorOptions {\r\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/cause\r\n        cause?: unknown;\r\n    }\r\n\r\n    interface ErrorConstructor {\r\n        new (message?: string, options?: ErrorOptions): Error;\r\n        (message?: string, options?: ErrorOptions): Error;\r\n    }\r\n\r\n    // eslint-disable-next-line no-var\r\n    var Error: ErrorConstructor;\r\n\r\n    // https://github.com/microsoft/TypeScript/issues/28308#issuecomment-650802278\r\n    interface AudioWorkletProcessor {\r\n        readonly port: MessagePort;\r\n        process(inputs: Float32Array[][], outputs: Float32Array[][], parameters: Record<string, Float32Array>): boolean;\r\n    }\r\n\r\n    // https://github.com/microsoft/TypeScript/issues/28308#issuecomment-650802278\r\n    const AudioWorkletProcessor: {\r\n        prototype: AudioWorkletProcessor;\r\n        new (options?: AudioWorkletNodeOptions): AudioWorkletProcessor;\r\n    };\r\n\r\n    // https://github.com/microsoft/TypeScript-DOM-lib-generator/issues/1029#issuecomment-881509595\r\n    interface AudioParamDescriptor {\r\n        readonly port: MessagePort;\r\n    }\r\n\r\n    // https://github.com/microsoft/TypeScript/issues/28308#issuecomment-650802278\r\n    function registerProcessor(\r\n        name: string,\r\n        processorCtor: (new (options?: AudioWorkletNodeOptions) => AudioWorkletProcessor) & {\r\n            parameterDescriptors?: AudioParamDescriptor[];\r\n        },\r\n    ): void;\r\n\r\n    // eslint-disable-next-line no-var\r\n    var grecaptcha:\r\n        | undefined\r\n        | {\r\n              reset: (id: string) => void;\r\n              render: (\r\n                  divId: string,\r\n                  options: {\r\n                      sitekey: string;\r\n                      callback: (response: string) => void;\r\n                  },\r\n              ) => string;\r\n              isReady: () => boolean;\r\n          };\r\n\r\n    // eslint-disable-next-line no-var, camelcase\r\n    var mx_rage_logger: ConsoleLogger;\r\n    // eslint-disable-next-line no-var, camelcase\r\n    var mx_rage_initPromise: Promise<void>;\r\n    // eslint-disable-next-line no-var, camelcase\r\n    var mx_rage_initStoragePromise: Promise<void>;\r\n    // eslint-disable-next-line no-var, camelcase\r\n    var mx_rage_store: IndexedDBLogStore;\r\n}\r\n\r\n/* eslint-enable @typescript-eslint/naming-convention */\r\n"],"mappings":";;AAgBAA,OAAA;AACAA,OAAA"}