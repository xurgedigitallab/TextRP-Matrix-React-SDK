{"version":3,"file":"RoomListLayoutStore.js","names":["_logger","require","_ListLayout","_AsyncStoreWithClient","_dispatcher","_interopRequireDefault","RoomListLayoutStore","AsyncStoreWithClient","constructor","defaultDispatcher","_defineProperty2","default","Map","instance","internalInstance","start","ensureLayoutExists","tagId","layoutMap","has","set","ListLayout","getLayoutFor","get","resetLayouts","logger","warn","layout","values","reset","onNotReady","clear","onAction","payload","exports","window","mxRoomListLayoutStore"],"sources":["../../../src/stores/room-list/RoomListLayoutStore.ts"],"sourcesContent":["/*\r\nCopyright 2020 The Matrix.org Foundation C.I.C.\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n*/\r\n\r\nimport { logger } from \"matrix-js-sdk/src/logger\";\r\n\r\nimport { TagID } from \"./models\";\r\nimport { ListLayout } from \"./ListLayout\";\r\nimport { AsyncStoreWithClient } from \"../AsyncStoreWithClient\";\r\nimport defaultDispatcher from \"../../dispatcher/dispatcher\";\r\nimport { ActionPayload } from \"../../dispatcher/payloads\";\r\n\r\ninterface IState {}\r\n\r\nexport default class RoomListLayoutStore extends AsyncStoreWithClient<IState> {\r\n    private static internalInstance: RoomListLayoutStore;\r\n\r\n    private readonly layoutMap = new Map<TagID, ListLayout>();\r\n\r\n    public constructor() {\r\n        super(defaultDispatcher);\r\n    }\r\n\r\n    public static get instance(): RoomListLayoutStore {\r\n        if (!this.internalInstance) {\r\n            this.internalInstance = new RoomListLayoutStore();\r\n            this.internalInstance.start();\r\n        }\r\n        return RoomListLayoutStore.internalInstance;\r\n    }\r\n\r\n    public ensureLayoutExists(tagId: TagID): void {\r\n        if (!this.layoutMap.has(tagId)) {\r\n            this.layoutMap.set(tagId, new ListLayout(tagId));\r\n        }\r\n    }\r\n\r\n    public getLayoutFor(tagId: TagID): ListLayout {\r\n        if (!this.layoutMap.has(tagId)) {\r\n            this.layoutMap.set(tagId, new ListLayout(tagId));\r\n        }\r\n        return this.layoutMap.get(tagId)!;\r\n    }\r\n\r\n    // Note: this primarily exists for debugging, and isn't really intended to be used by anything.\r\n    public async resetLayouts(): Promise<void> {\r\n        logger.warn(\"Resetting layouts for room list\");\r\n        for (const layout of this.layoutMap.values()) {\r\n            layout.reset();\r\n        }\r\n    }\r\n\r\n    protected async onNotReady(): Promise<any> {\r\n        // On logout, clear the map.\r\n        this.layoutMap.clear();\r\n    }\r\n\r\n    // We don't need this function, but our contract says we do\r\n    protected async onAction(payload: ActionPayload): Promise<void> {}\r\n}\r\n\r\nwindow.mxRoomListLayoutStore = RoomListLayoutStore.instance;\r\n"],"mappings":";;;;;;;;AAgBA,IAAAA,OAAA,GAAAC,OAAA;AAGA,IAAAC,WAAA,GAAAD,OAAA;AACA,IAAAE,qBAAA,GAAAF,OAAA;AACA,IAAAG,WAAA,GAAAC,sBAAA,CAAAJ,OAAA;AArBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAYe,MAAMK,mBAAmB,SAASC,0CAAoB,CAAS;EAKnEC,WAAWA,CAAA,EAAG;IACjB,KAAK,CAACC,mBAAiB,CAAC;IAAC,IAAAC,gBAAA,CAAAC,OAAA,qBAHA,IAAIC,GAAG,CAAoB,CAAC;EAIzD;EAEA,WAAkBC,QAAQA,CAAA,EAAwB;IAC9C,IAAI,CAAC,IAAI,CAACC,gBAAgB,EAAE;MACxB,IAAI,CAACA,gBAAgB,GAAG,IAAIR,mBAAmB,CAAC,CAAC;MACjD,IAAI,CAACQ,gBAAgB,CAACC,KAAK,CAAC,CAAC;IACjC;IACA,OAAOT,mBAAmB,CAACQ,gBAAgB;EAC/C;EAEOE,kBAAkBA,CAACC,KAAY,EAAQ;IAC1C,IAAI,CAAC,IAAI,CAACC,SAAS,CAACC,GAAG,CAACF,KAAK,CAAC,EAAE;MAC5B,IAAI,CAACC,SAAS,CAACE,GAAG,CAACH,KAAK,EAAE,IAAII,sBAAU,CAACJ,KAAK,CAAC,CAAC;IACpD;EACJ;EAEOK,YAAYA,CAACL,KAAY,EAAc;IAC1C,IAAI,CAAC,IAAI,CAACC,SAAS,CAACC,GAAG,CAACF,KAAK,CAAC,EAAE;MAC5B,IAAI,CAACC,SAAS,CAACE,GAAG,CAACH,KAAK,EAAE,IAAII,sBAAU,CAACJ,KAAK,CAAC,CAAC;IACpD;IACA,OAAO,IAAI,CAACC,SAAS,CAACK,GAAG,CAACN,KAAK,CAAC;EACpC;;EAEA;EACA,MAAaO,YAAYA,CAAA,EAAkB;IACvCC,cAAM,CAACC,IAAI,CAAC,iCAAiC,CAAC;IAC9C,KAAK,MAAMC,MAAM,IAAI,IAAI,CAACT,SAAS,CAACU,MAAM,CAAC,CAAC,EAAE;MAC1CD,MAAM,CAACE,KAAK,CAAC,CAAC;IAClB;EACJ;EAEA,MAAgBC,UAAUA,CAAA,EAAiB;IACvC;IACA,IAAI,CAACZ,SAAS,CAACa,KAAK,CAAC,CAAC;EAC1B;;EAEA;EACA,MAAgBC,QAAQA,CAACC,OAAsB,EAAiB,CAAC;AACrE;AAACC,OAAA,CAAAvB,OAAA,GAAAL,mBAAA;AAAA,IAAAI,gBAAA,CAAAC,OAAA,EA7CoBL,mBAAmB;AA+CxC6B,MAAM,CAACC,qBAAqB,GAAG9B,mBAAmB,CAACO,QAAQ"}