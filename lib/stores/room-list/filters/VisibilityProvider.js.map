{"version":3,"file":"VisibilityProvider.js","names":["_LegacyCallHandler","_interopRequireDefault","require","_RoomList","_isLocalRoom","_VoipUserMapper","VisibilityProvider","constructor","instance","internalInstance","onNewInvitedRoom","room","VoipUserMapper","sharedInstance","isRoomVisible","LegacyCallHandler","getSupportsVirtualRooms","isVirtualRoom","isSpaceRoom","isLocalRoom","isVisibleFn","RoomListCustomisations","exports","_defineProperty2","default"],"sources":["../../../../src/stores/room-list/filters/VisibilityProvider.ts"],"sourcesContent":["/*\r\n * Copyright 2020 The Matrix.org Foundation C.I.C.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *         http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { Room } from \"matrix-js-sdk/src/models/room\";\r\n\r\nimport LegacyCallHandler from \"../../../LegacyCallHandler\";\r\nimport { RoomListCustomisations } from \"../../../customisations/RoomList\";\r\nimport { isLocalRoom } from \"../../../utils/localRoom/isLocalRoom\";\r\nimport VoipUserMapper from \"../../../VoipUserMapper\";\r\n\r\nexport class VisibilityProvider {\r\n    private static internalInstance: VisibilityProvider;\r\n\r\n    private constructor() {}\r\n\r\n    public static get instance(): VisibilityProvider {\r\n        if (!VisibilityProvider.internalInstance) {\r\n            VisibilityProvider.internalInstance = new VisibilityProvider();\r\n        }\r\n        return VisibilityProvider.internalInstance;\r\n    }\r\n\r\n    public async onNewInvitedRoom(room: Room): Promise<void> {\r\n        await VoipUserMapper.sharedInstance().onNewInvitedRoom(room);\r\n    }\r\n\r\n    public isRoomVisible(room?: Room): boolean {\r\n        if (!room) {\r\n            return false;\r\n        }\r\n\r\n        if (\r\n            LegacyCallHandler.instance.getSupportsVirtualRooms() &&\r\n            VoipUserMapper.sharedInstance().isVirtualRoom(room)\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        // hide space rooms as they'll be shown in the SpacePanel\r\n        if (room.isSpaceRoom()) {\r\n            return false;\r\n        }\r\n\r\n        if (isLocalRoom(room)) {\r\n            // local rooms shouldn't show up anywhere\r\n            return false;\r\n        }\r\n\r\n        const isVisibleFn = RoomListCustomisations.isRoomVisible;\r\n        if (isVisibleFn) {\r\n            return isVisibleFn(room);\r\n        }\r\n\r\n        return true; // default\r\n    }\r\n}\r\n"],"mappings":";;;;;;;;AAkBA,IAAAA,kBAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAD,OAAA;AACA,IAAAE,YAAA,GAAAF,OAAA;AACA,IAAAG,eAAA,GAAAJ,sBAAA,CAAAC,OAAA;AArBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASO,MAAMI,kBAAkB,CAAC;EAGpBC,WAAWA,CAAA,EAAG,CAAC;EAEvB,WAAkBC,QAAQA,CAAA,EAAuB;IAC7C,IAAI,CAACF,kBAAkB,CAACG,gBAAgB,EAAE;MACtCH,kBAAkB,CAACG,gBAAgB,GAAG,IAAIH,kBAAkB,CAAC,CAAC;IAClE;IACA,OAAOA,kBAAkB,CAACG,gBAAgB;EAC9C;EAEA,MAAaC,gBAAgBA,CAACC,IAAU,EAAiB;IACrD,MAAMC,uBAAc,CAACC,cAAc,CAAC,CAAC,CAACH,gBAAgB,CAACC,IAAI,CAAC;EAChE;EAEOG,aAAaA,CAACH,IAAW,EAAW;IACvC,IAAI,CAACA,IAAI,EAAE;MACP,OAAO,KAAK;IAChB;IAEA,IACII,0BAAiB,CAACP,QAAQ,CAACQ,uBAAuB,CAAC,CAAC,IACpDJ,uBAAc,CAACC,cAAc,CAAC,CAAC,CAACI,aAAa,CAACN,IAAI,CAAC,EACrD;MACE,OAAO,KAAK;IAChB;;IAEA;IACA,IAAIA,IAAI,CAACO,WAAW,CAAC,CAAC,EAAE;MACpB,OAAO,KAAK;IAChB;IAEA,IAAI,IAAAC,wBAAW,EAACR,IAAI,CAAC,EAAE;MACnB;MACA,OAAO,KAAK;IAChB;IAEA,MAAMS,WAAW,GAAGC,gCAAsB,CAACP,aAAa;IACxD,IAAIM,WAAW,EAAE;MACb,OAAOA,WAAW,CAACT,IAAI,CAAC;IAC5B;IAEA,OAAO,IAAI,CAAC,CAAC;EACjB;AACJ;AAACW,OAAA,CAAAhB,kBAAA,GAAAA,kBAAA;AAAA,IAAAiB,gBAAA,CAAAC,OAAA,EA7CYlB,kBAAkB"}