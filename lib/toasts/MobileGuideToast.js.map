{"version":3,"file":"MobileGuideToast.js","names":["_languageHandler","require","_GenericToast","_interopRequireDefault","_ToastStore","_SdkConfig","onAccept","window","location","href","onReject","document","cookie","hideToast","TOAST_KEY","showToast","isIos","test","navigator","userAgent","MSStream","isAndroid","brand","SdkConfig","get","includes","ToastStore","sharedInstance","addOrReplaceToast","key","title","_t","props","description","acceptLabel","rejectLabel","component","GenericToast","priority","exports","dismissToast"],"sources":["../../src/toasts/MobileGuideToast.ts"],"sourcesContent":["/*\r\nCopyright 2021 The Matrix.org Foundation C.I.C.\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\nhttp://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n*/\r\n\r\nimport { _t } from \"../languageHandler\";\r\nimport GenericToast from \"../components/views/toasts/GenericToast\";\r\nimport ToastStore from \"../stores/ToastStore\";\r\nimport SdkConfig from \"../SdkConfig\";\r\n\r\nconst onAccept = (): void => {\r\n    window.location.href = \"mobile_guide/\";\r\n};\r\n\r\nconst onReject = (): void => {\r\n    document.cookie = \"element_mobile_redirect_to_guide=false;path=/;max-age=14400\";\r\n    hideToast();\r\n};\r\n\r\nconst TOAST_KEY = \"mobileguide\";\r\n\r\nexport const showToast = (): void => {\r\n    const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n    const isAndroid = /Android/.test(navigator.userAgent);\r\n    const brand = SdkConfig.get().brand;\r\n    if (!isIos && !isAndroid) {\r\n        return;\r\n    }\r\n    if (document.cookie.includes(\"element_mobile_redirect_to_guide=false\")) {\r\n        return;\r\n    }\r\n    ToastStore.sharedInstance().addOrReplaceToast({\r\n        key: TOAST_KEY,\r\n        title: _t(\"Use app for a better experience\"),\r\n        props: {\r\n            description: _t(\r\n                \"%(brand)s is experimental on a mobile web browser. \" +\r\n                    \"For a better experience and the latest features, use our free native app.\",\r\n                { brand },\r\n            ),\r\n            acceptLabel: _t(\"Use app\"),\r\n            onAccept,\r\n            rejectLabel: _t(\"Dismiss\"),\r\n            onReject,\r\n        },\r\n        component: GenericToast,\r\n        priority: 99,\r\n    });\r\n};\r\n\r\nexport const hideToast = (): void => {\r\n    ToastStore.sharedInstance().dismissToast(TOAST_KEY);\r\n};\r\n"],"mappings":";;;;;;;AAgBA,IAAAA,gBAAA,GAAAC,OAAA;AACA,IAAAC,aAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,WAAA,GAAAD,sBAAA,CAAAF,OAAA;AACA,IAAAI,UAAA,GAAAF,sBAAA,CAAAF,OAAA;AAnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAOA,MAAMK,QAAQ,GAAGA,CAAA,KAAY;EACzBC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,eAAe;AAC1C,CAAC;AAED,MAAMC,QAAQ,GAAGA,CAAA,KAAY;EACzBC,QAAQ,CAACC,MAAM,GAAG,6DAA6D;EAC/EC,SAAS,CAAC,CAAC;AACf,CAAC;AAED,MAAMC,SAAS,GAAG,aAAa;AAExB,MAAMC,SAAS,GAAGA,CAAA,KAAY;EACjC,MAAMC,KAAK,GAAG,kBAAkB,CAACC,IAAI,CAACC,SAAS,CAACC,SAAS,CAAC,IAAI,CAACZ,MAAM,CAACa,QAAQ;EAC9E,MAAMC,SAAS,GAAG,SAAS,CAACJ,IAAI,CAACC,SAAS,CAACC,SAAS,CAAC;EACrD,MAAMG,KAAK,GAAGC,kBAAS,CAACC,GAAG,CAAC,CAAC,CAACF,KAAK;EACnC,IAAI,CAACN,KAAK,IAAI,CAACK,SAAS,EAAE;IACtB;EACJ;EACA,IAAIV,QAAQ,CAACC,MAAM,CAACa,QAAQ,CAAC,wCAAwC,CAAC,EAAE;IACpE;EACJ;EACAC,mBAAU,CAACC,cAAc,CAAC,CAAC,CAACC,iBAAiB,CAAC;IAC1CC,GAAG,EAAEf,SAAS;IACdgB,KAAK,EAAE,IAAAC,mBAAE,EAAC,iCAAiC,CAAC;IAC5CC,KAAK,EAAE;MACHC,WAAW,EAAE,IAAAF,mBAAE,EACX,qDAAqD,GACjD,2EAA2E,EAC/E;QAAET;MAAM,CACZ,CAAC;MACDY,WAAW,EAAE,IAAAH,mBAAE,EAAC,SAAS,CAAC;MAC1BzB,QAAQ;MACR6B,WAAW,EAAE,IAAAJ,mBAAE,EAAC,SAAS,CAAC;MAC1BrB;IACJ,CAAC;IACD0B,SAAS,EAAEC,qBAAY;IACvBC,QAAQ,EAAE;EACd,CAAC,CAAC;AACN,CAAC;AAACC,OAAA,CAAAxB,SAAA,GAAAA,SAAA;AAEK,MAAMF,SAAS,GAAGA,CAAA,KAAY;EACjCa,mBAAU,CAACC,cAAc,CAAC,CAAC,CAACa,YAAY,CAAC1B,SAAS,CAAC;AACvD,CAAC;AAACyB,OAAA,CAAA1B,SAAA,GAAAA,SAAA"}