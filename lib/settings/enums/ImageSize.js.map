{"version":3,"file":"ImageSize.js","names":["SIZE_LARGE","w","h","SIZE_NORMAL_LANDSCAPE","SIZE_NORMAL_PORTRAIT","Math","ceil","ImageSize","exports","suggestedSize","size","contentSize","maxHeight","aspectRatio","portrait","maxSize","Large","constrainedSize","min","floor"],"sources":["../../../src/settings/enums/ImageSize.ts"],"sourcesContent":["/*\r\nCopyright 2021 The Matrix.org Foundation C.I.C.\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n*/\r\n\r\n// For Large the image gets drawn as big as possible.\r\n// constraint by: timeline width, manual height overrides, SIZE_LARGE.h\r\nconst SIZE_LARGE = { w: 800, h: 600 };\r\n// For Normal the image gets drawn to never exceed SIZE_NORMAL.w, SIZE_NORMAL.h\r\n// constraint by: timeline width, manual height overrides\r\nconst SIZE_NORMAL_LANDSCAPE = { w: 324, h: 324 }; // for w > h\r\nconst SIZE_NORMAL_PORTRAIT = { w: Math.ceil(324 * (9 / 16)), h: 324 }; // for h > w\r\n\r\ntype Dimensions = { w?: number; h?: number };\r\n\r\nexport enum ImageSize {\r\n    Normal = \"normal\",\r\n    Large = \"large\",\r\n}\r\n\r\n/**\r\n * @param {ImageSize} size The user's image size preference\r\n * @param {Dimensions} contentSize The natural dimensions of the content\r\n * @param {number} maxHeight Overrides the default height limit\r\n * @returns {Dimensions} The suggested maximum dimensions for the image\r\n */\r\nexport function suggestedSize(size: ImageSize, contentSize: Dimensions, maxHeight?: number): Required<Dimensions> {\r\n    const aspectRatio = contentSize.w! / contentSize.h!;\r\n    const portrait = aspectRatio < 1;\r\n\r\n    const maxSize = size === ImageSize.Large ? SIZE_LARGE : portrait ? SIZE_NORMAL_PORTRAIT : SIZE_NORMAL_LANDSCAPE;\r\n    if (!contentSize.w || !contentSize.h) {\r\n        return maxSize;\r\n    }\r\n\r\n    const constrainedSize = {\r\n        w: Math.min(maxSize.w, contentSize.w),\r\n        h: maxHeight ? Math.min(maxSize.h, contentSize.h, maxHeight) : Math.min(maxSize.h, contentSize.h),\r\n    };\r\n\r\n    if (constrainedSize.h * aspectRatio < constrainedSize.w) {\r\n        // Height dictates width\r\n        return { w: Math.floor(constrainedSize.h * aspectRatio), h: constrainedSize.h };\r\n    } else {\r\n        // Width dictates height\r\n        return { w: constrainedSize.w, h: Math.floor(constrainedSize.w / aspectRatio) };\r\n    }\r\n}\r\n"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAMA,UAAU,GAAG;EAAEC,CAAC,EAAE,GAAG;EAAEC,CAAC,EAAE;AAAI,CAAC;AACrC;AACA;AACA,MAAMC,qBAAqB,GAAG;EAAEF,CAAC,EAAE,GAAG;EAAEC,CAAC,EAAE;AAAI,CAAC,CAAC,CAAC;AAClD,MAAME,oBAAoB,GAAG;EAAEH,CAAC,EAAEI,IAAI,CAACC,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;EAAEJ,CAAC,EAAE;AAAI,CAAC,CAAC,CAAC;AAAA,IAI3DK,SAAS,0BAATA,SAAS;EAATA,SAAS;EAATA,SAAS;EAAA,OAATA,SAAS;AAAA;AAKrB;AACA;AACA;AACA;AACA;AACA;AALAC,OAAA,CAAAD,SAAA,GAAAA,SAAA;AAMO,SAASE,aAAaA,CAACC,IAAe,EAAEC,WAAuB,EAAEC,SAAkB,EAAwB;EAC9G,MAAMC,WAAW,GAAGF,WAAW,CAACV,CAAC,GAAIU,WAAW,CAACT,CAAE;EACnD,MAAMY,QAAQ,GAAGD,WAAW,GAAG,CAAC;EAEhC,MAAME,OAAO,GAAGL,IAAI,KAAKH,SAAS,CAACS,KAAK,GAAGhB,UAAU,GAAGc,QAAQ,GAAGV,oBAAoB,GAAGD,qBAAqB;EAC/G,IAAI,CAACQ,WAAW,CAACV,CAAC,IAAI,CAACU,WAAW,CAACT,CAAC,EAAE;IAClC,OAAOa,OAAO;EAClB;EAEA,MAAME,eAAe,GAAG;IACpBhB,CAAC,EAAEI,IAAI,CAACa,GAAG,CAACH,OAAO,CAACd,CAAC,EAAEU,WAAW,CAACV,CAAC,CAAC;IACrCC,CAAC,EAAEU,SAAS,GAAGP,IAAI,CAACa,GAAG,CAACH,OAAO,CAACb,CAAC,EAAES,WAAW,CAACT,CAAC,EAAEU,SAAS,CAAC,GAAGP,IAAI,CAACa,GAAG,CAACH,OAAO,CAACb,CAAC,EAAES,WAAW,CAACT,CAAC;EACpG,CAAC;EAED,IAAIe,eAAe,CAACf,CAAC,GAAGW,WAAW,GAAGI,eAAe,CAAChB,CAAC,EAAE;IACrD;IACA,OAAO;MAAEA,CAAC,EAAEI,IAAI,CAACc,KAAK,CAACF,eAAe,CAACf,CAAC,GAAGW,WAAW,CAAC;MAAEX,CAAC,EAAEe,eAAe,CAACf;IAAE,CAAC;EACnF,CAAC,MAAM;IACH;IACA,OAAO;MAAED,CAAC,EAAEgB,eAAe,CAAChB,CAAC;MAAEC,CAAC,EAAEG,IAAI,CAACc,KAAK,CAACF,eAAe,CAAChB,CAAC,GAAGY,WAAW;IAAE,CAAC;EACnF;AACJ"}